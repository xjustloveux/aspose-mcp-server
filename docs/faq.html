<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>常見問答 - Aspose MCP Server</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    <meta name="description" content="Aspose MCP Server 常見問答：索引行為、授權配置、參數使用等問題解答。">
    <meta name="keywords" content="Aspose, MCP, 常見問答, FAQ, 索引行為, 授權配置, 問題解答">
    <link rel="canonical" href="https://xjustloveux.github.io/aspose-mcp-server/faq.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://xjustloveux.github.io/aspose-mcp-server/faq.html">
    <meta property="og:title" content="常見問答 - Aspose MCP Server">
    <meta property="og:description" content="Aspose MCP Server 常見問答：索引行為、授權配置、參數使用等問題解答。">
    <meta property="og:site_name" content="Aspose MCP Server">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://xjustloveux.github.io/aspose-mcp-server/faq.html">
    <meta property="twitter:title" content="常見問答 - Aspose MCP Server">
    <meta property="twitter:description" content="Aspose MCP Server 常見問答：索引行為、授權配置、參數使用等問題解答。">
    <link rel="stylesheet" href="theme.css">
    <script src="theme.js"></script>
    <style>
        /* Page-specific styles */
        .faq-item {
            margin-bottom: 20px;
            padding: 25px;
            background: var(--faq-item-bg);
            border-radius: 8px;
            border-left: 4px solid var(--accent-primary);
        }

        .faq-question {
            color: var(--accent-secondary);
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .faq-answer {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .faq-answer ul,
        .faq-answer ol {
            margin-top: 10px;
            padding-left: 25px;
        }

        /* Page-specific RWD */
        @media (max-width: 768px) {
            .faq-item {
                margin-bottom: 20px;
                padding-bottom: 15px;
            }

            .faq-question {
                font-size: 1.1em;
            }

            .faq-answer {
                font-size: 0.95em;
            }
        }

        @media (max-width: 480px) {
            .faq-question {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
<nav>
    <div class="nav-container">
        <div class="nav-header">
            <a href="index.html" class="nav-logo"><img src="favicon.svg" alt="Aspose MCP Server"> Aspose MCP Server</a>
            <ul class="nav-menu" id="navMenu">
                <li>
                    <a href="index.html">首頁</a>
                </li>
                <li>
                    <a href="features.html">功能特性</a>
                </li>
                <li>
                    <a href="tools.html">工具列表</a>
                </li>
                <li>
                    <a href="getting-started.html">快速開始</a>
                </li>
                <li>
                    <a href="developers.html">開發者指南</a>
                </li>
                <li>
                    <a href="deployment.html">部署指南</a>
                </li>
                <li>
                    <a href="faq.html" class="active">常見問答</a>
                </li>
            </ul>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="切換亮/暗色主題">🌙</button>
            <button class="menu-toggle" aria-label="Toggle menu">☰</button>
        </div>
    </div>
</nav>

<div class="page-header">
    <div class="container">
        <h1>❓ 常見問答</h1>
        <p>常見問題解答</p>
    </div>
</div>

<div class="container">
<div class="section">
    <h2>🚀 快速開始相關</h2>

    <div class="faq-item">
        <div class="faq-question">Q: 如何確認工具是否正常運行？</div>
        <div class="faq-answer">
            <p>啟動 MCP 客戶端後，檢查工具列表是否包含 <code>word_*</code>、<code>excel_*</code> 等工具。如果沒有，請檢查：</p>
            <ol>
                <li>配置檔案路徑是否正確</li>
                <li>可執行檔案是否有執行權限（Linux/macOS）</li>
                <li>授權檔案是否正確配置</li>
                <li>查看 MCP 客戶端的錯誤日誌</li>
            </ol>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 可以同時啟用多個工具類型嗎？</div>
        <div class="faq-answer">
            <p>可以。使用 <code>--all</code> 參數或同時指定多個參數，例如：</p>
            <div class="code-block">
                {
                "args": ["--word", "--excel", "--pdf"]
                }
            </div>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 轉換工具何時可用？</div>
        <div class="faq-answer">
            <ul>
                <li><code>convert_to_pdf</code>：啟用任何文檔工具（<code>--word</code>、<code>--excel</code>、<code>--ppt</code>）時自動可用</li>
                <li><code>convert_document</code>：啟用兩個或以上文檔工具時自動可用</li>
            </ul>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 支援哪些文檔格式？</div>
        <div class="faq-answer">
            <ul>
                <li><strong>Word</strong>: DOC、DOCX、RTF、ODT、HTML、TXT 等</li>
                <li><strong>Excel</strong>: XLS、XLSX、CSV、ODS、HTML 等</li>
                <li><strong>PowerPoint</strong>: PPT、PPTX、ODP、HTML 等</li>
                <li><strong>PDF</strong>: PDF（讀寫、編輯、簽名等）</li>
            </ul>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 如何在 Linux/macOS 上設置執行權限？</div>
        <div class="faq-answer">
            <div class="code-block">
                chmod +x AsposeMcpServer
            </div>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: Linux/macOS 需要安裝 libgdiplus 嗎？</div>
        <div class="faq-answer">
            <p><strong>不需要。</strong>所有功能已原生支援跨平台運行：</p>
            <ul>
                <li>PowerPoint 使用 <code>Aspose.Slides.NET6.CrossPlatform</code>（內建 C++ 圖形引擎）</li>
                <li>PDF 使用 <code>Aspose.PDF.Drawing</code>（Aspose.Drawing 後端）</li>
                <li>Word / Excel 透過 SkiaSharp 原生資源提供圖形支援</li>
            </ul>
            <p>Linux 環境建議安裝字型套件（<code>fonts-liberation</code> 或 <code>ttf-mscorefonts-installer</code>）以確保文檔正確呈現。macOS 已內建常用字型，無需額外安裝。</p>
        </div>
    </div>
</div>

<div class="section">
    <h2>🔑 授權配置相關</h2>

    <div class="faq-item">
        <div class="faq-question">Q: 為什麼生成的文檔有試用版標記？</div>
        <div class="faq-answer">
            <p>這表示授權檔案未正確載入。請檢查：</p>
            <ol>
                <li>授權檔案路徑是否正確</li>
                <li>授權檔案是否與 Aspose 版本相容（當前版本：23.10.0）</li>
                <li>授權檔案是否有效且未過期</li>
            </ol>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 找不到授權檔案會怎樣？</div>
        <div class="faq-answer">
            <p>如果找不到授權檔案，系統會以<strong>試用模式</strong>運行，生成的文檔會有試用版標記。</p>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 支援哪些授權類型？</div>
        <div class="faq-answer">
            <ul>
                <li><strong>總授權</strong>：<code>Aspose.Total.lic</code>（包含所有組件，推薦）</li>
                <li><strong>單一組件授權</strong>：<code>Aspose.Words.lic</code>、<code>Aspose.Cells.lic</code>、<code>Aspose.Slides.lic</code>、<code>Aspose.Pdf.lic</code></li>
            </ul>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 如何配置授權檔案？</div>
        <div class="faq-answer">
            <p>有三種方式（按優先順序）：</p>
            <ol>
                <li><strong>命令列參數</strong>（最高優先級）：<code>--license:路徑</code> 或 <code>--license=路徑</code></li>
                <li><strong>環境變數</strong>：設定 <code>ASPOSE_LICENSE_PATH</code> 環境變數</li>
                <li><strong>自動搜尋</strong>（預設）：在可執行檔案同一目錄搜尋常見授權檔案名稱</li>
            </ol>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 本專案的源代碼使用什麼授權？</div>
        <div class="faq-answer">
            <p>
                本專案的源代碼採用
                <a href="https://github.com/xjustloveux/aspose-mcp-server/blob/master/LICENSE" target="_blank">
                    <strong>MIT License</strong>
                </a> 授權。
            </p>
            <p style="margin-top: 10px;">您可以：</p>
            <ul>
                <li>✅ 自由使用、修改和分發源代碼</li>
                <li>✅ 用於商業或非商業項目</li>
                <li>✅ 私有使用</li>
            </ul>
            <p style="margin-top: 10px;"><strong>注意</strong>：雖然源代碼使用 MIT License，但使用本專案需要有效的 Aspose 授權檔案才能正常運行（Aspose 是商業軟體）。</p>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 評估模式（無授權）有什麼限制？</div>
        <div class="faq-answer">
            <p>在無授權（評估模式）下運行時，Aspose 組件會有以下限制：</p>
            <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                <thead>
                <tr style="background: var(--bg-step);">
                    <th style="padding: 10px; text-align: left; border: 1px solid var(--border-color);">組件</th>
                    <th style="padding: 10px; text-align: left; border: 1px solid var(--border-color);">限制說明</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">
                        <strong>Aspose.Words</strong>
                    </td>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">字型格式（名稱、大小、顏色）可能無法正確應用；文檔會包含評估版水印</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">
                        <strong>Aspose.Cells</strong>
                    </td>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">多工作表操作受限（如跨工作表存取）；工作簿會包含評估版工作表</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">
                        <strong>Aspose.Slides</strong>
                    </td>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">文字替換時可能包含水印文字；投影片可能包含評估版標記</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">
                        <strong>Aspose.PDF</strong>
                    </td>
                    <td style="padding: 10px; border: 1px solid var(--border-color);">集合限制為最多 4 個元素（如頁面數限制）；PDF 會包含評估版水印</td>
                </tr>
                </tbody>
            </table>
            <div class="info-box" style="margin-top: 15px;">
                <strong>💡 注意事項</strong>
                <ul style="margin-top: 10px; margin-bottom: 0;">
                    <li>大部分基本操作（讀取、創建、簡單編輯）在評估模式下仍可正常運行</li>
                    <li>評估模式適合測試和開發，但不建議用於生產環境</li>
                    <li>使用 <code>test.ps1 -SkipLicense</code> 可在評估模式下運行單元測試</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="section">
    <h2>🔢 索引行為相關</h2>

    <div class="faq-item">
        <div class="faq-question">Q: 為什麼刪除操作後索引會變化？</div>
        <div class="faq-answer">
            <p>當執行刪除操作（如刪除段落、表格、圖片等）後，後續元素的索引會自動調整。這是正常行為，因為索引是基於當前文檔狀態的。</p>
            <div class="info-box">
                <strong>建議</strong>：在執行刪除操作後，重新使用 <code>get</code> 操作獲取最新的索引列表。
            </div>
            <p>
                <strong>範例：</strong>
            </p>
            <div class="code-block">
                1. word_image(operation='get', path='doc.docx') # 返回圖片索引: 0, 1, 2
                2. word_image(operation='delete', path='doc.docx', imageIndex=1) # 刪除索引1的圖片
                3. word_image(operation='get', path='doc.docx') # 現在返回: 0, 1 (原索引2變成1)
            </div>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: paragraphIndex 的有效範圍是什麼？</div>
        <div class="faq-answer">
            <p>有效範圍：<code>0</code> 到 <code>段落總數-1</code>，或使用 <code>-1</code> 表示最後一個段落。</p>
            <ul>
                <li>使用 <code>get</code> 操作可以獲取當前文檔的段落總數</li>
                <li>某些操作（如 <code>word_hyperlink</code> 的 <code>add</code>）會在指定段落<strong>之後</strong>創建新段落，而不是插入到段落內部</li>
                <li>刪除段落後，後續段落的索引會自動調整</li>
            </ul>
        </div>
    </div>
</div>

<div class="section">
    <h2>⚙️ 功能使用相關</h2>

    <div class="faq-item">
        <div class="faq-question">Q: 轉換功能什麼時候自動可用？</div>
        <div class="faq-answer">
            <ul>
                <li>啟用任何文檔工具（<code>--word</code>、<code>--excel</code>、<code>--ppt</code>）時，自動包含 <code>convert_to_pdf</code>（轉換為PDF）</li>
                <li>啟用兩個或以上文檔工具時，自動包含 <code>convert_document</code>（跨格式轉換，如Word轉Excel）</li>
            </ul>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 參數命名有哪些兼容方式？</div>
        <div class="faq-answer">
            <p>為了向後兼容，某些參數支援多種命名方式：</p>
            <ul>
                <li><code>startColumn</code> / <code>startCol</code></li>
                <li><code>columnIndex</code> / <code>colIndex</code></li>
                <li><code>tableIndex</code> / <code>sourceTableIndex</code></li>
                <li><code>text</code> / <code>replyText</code> (用於評論回覆)</li>
            </ul>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 可以自訂工具嗎？</div>
        <div class="faq-answer">
            <p>可以。工具使用 MCP SDK 的 <code>[McpServerToolType]</code> 屬性自動發現：</p>
            <ol>
                <li>創建新的工具類並添加 <code>[McpServerToolType]</code> 屬性</li>
                <li>遵循命名約定（<code>*Tool.cs</code>）</li>
                <li>放在對應的 <code>Tools/</code> 子目錄中</li>
                <li>工具會透過 MCP SDK 自動註冊</li>
            </ol>
        </div>
    </div>
</div>

<div class="section">
    <h2>🔒 安全與錯誤相關</h2>

    <div class="faq-item">
        <div class="faq-question">Q: 錯誤訊息顯示路徑無效怎麼辦？</div>
        <div class="faq-answer">
            <p>檢查：</p>
            <ol>
                <li>路徑是否使用正確的分隔符（Windows 可用 <code>/</code> 或 <code>\\</code>）</li>
                <li>路徑長度是否超過 260 字元（Windows 限制）</li>
                <li>檔案名稱是否包含非法字元</li>
                <li>是否啟用了絕對路徑（某些工具可能需要）</li>
            </ol>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 如何查看詳細的錯誤資訊？</div>
        <div class="faq-answer">
            <p>檢查 MCP 客戶端的錯誤日誌。生產環境中，詳細錯誤資訊會被清理以防止資訊洩露。開發環境（DEBUG 模式）會顯示完整錯誤資訊。</p>
        </div>
    </div>

    <div class="faq-item">
        <div class="faq-question">Q: 有哪些安全限制？</div>
        <div class="faq-answer">
            <ul>
                <li><strong>最大路徑長度</strong>：260 字元</li>
                <li><strong>最大檔案名稱長度</strong>：255 字元</li>
                <li><strong>最大陣列大小</strong>：1000 項</li>
                <li><strong>最大字串長度</strong>：10000 字元</li>
            </ul>
        </div>
    </div>
</div>

</div>

<footer>
    <div class="container">
        <p>基於 .NET 8.0、Aspose.Total 23.10.0 和 MCP SDK 0.6.0 構建</p>
        <p class="footer-links" style="margin-top: 10px;">
            <a href="https://github.com/xjustloveux/aspose-mcp-server" target="_blank">GitHub</a> |
            <a href="https://www.aspose.com/" target="_blank">Aspose</a> |
            <a href="https://modelcontextprotocol.io/" target="_blank">MCP Protocol</a> |
            <a href="https://github.com/modelcontextprotocol/csharp-sdk" target="_blank">.NET MCP SDK</a>
        </p>
        <p class="copyright-text" style="margin-top: 20px; font-size: 0.9em;">
            © 2025 JaJa. All rights reserved. | MIT License
        </p>
    </div>
</footer>

<script>
        // 移除 code-block 和 structure-tree 內容的縮排，解決格式化後左邊空白的問題
        function trimEmptyLines(lines) {
            while (lines.length > 0 && lines[0].trim().length === 0) lines.shift();
            while (lines.length > 0 && lines[lines.length - 1].trim().length === 0) lines.pop();
            return lines;
        }

        function getMinIndent(lines) {
            let minIndent = Infinity;
            lines.forEach(function(line) {
                if (line.trim().length === 0) return;
                const trimmed = line.trimStart ? line.trimStart() : line.replace(/^\s+/, '');
                const indent = line.length - trimmed.length;
                if (indent < minIndent) minIndent = indent;
            });
            return minIndent;
        }

        function removeMinIndent(lines, minIndent) {
            return lines.map(function(line) {
                if (line.trim().length === 0) return '';
                return minIndent > 0 && minIndent < Infinity ? line.substring(minIndent) : line;
            });
        }

        function formatJsonLines(jsonLines) {
            let indentLevel = 0;
            const formattedLines = [];
            jsonLines.forEach(function(line) {
                const trimmed = line.trim();
                if (trimmed.length === 0) { formattedLines.push(''); return; }
                if (trimmed.startsWith('}') || trimmed.startsWith(']')) indentLevel = Math.max(0, indentLevel - 1);
                formattedLines.push('  '.repeat(indentLevel) + trimmed);
                if (trimmed.endsWith('{') || trimmed.endsWith('[') || trimmed === '{' || trimmed === '[') indentLevel++;
            });
            return formattedLines;
        }

        function processCodeBlock(block) {
            const text = block.textContent || block.innerText;
            const trimmedText = text.trim();
            const isJson = (trimmedText.startsWith('{') || trimmedText.startsWith('[')) &&
                           (trimmedText.includes('":') || trimmedText.includes('": '));
            let lines = trimEmptyLines(text.split('\n'));
            if (lines.length === 0) return;
            const minIndent = getMinIndent(lines);
            const cleanLines = removeMinIndent(lines, minIndent);
            block.textContent = isJson ? formatJsonLines(cleanLines).join('\n') : cleanLines.join('\n');
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.code-block, .structure-tree').forEach(processCodeBlock);
        });
    </script>

</body>
</html>
