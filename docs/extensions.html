<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å— - Aspose MCP Server</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    <meta name="description" content="Aspose MCP Server æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å—ï¼šæ“´å……åŠŸèƒ½é…ç½®ã€å‚³è¼¸æ¨¡å¼ã€æ¶ˆæ¯å”è­°ã€API æ“ä½œã€‚">
    <meta name="keywords" content="Aspose, MCP, Extension, æ“´å……åŠŸèƒ½, é–‹ç™¼æŒ‡å—, å‚³è¼¸æ¨¡å¼, æ¶ˆæ¯å”è­°">
    <link rel="canonical" href="https://xjustloveux.github.io/aspose-mcp-server/extensions.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://xjustloveux.github.io/aspose-mcp-server/extensions.html">
    <meta property="og:title" content="æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å— - Aspose MCP Server">
    <meta property="og:description" content="Aspose MCP Server æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å—ï¼šæ“´å……åŠŸèƒ½é…ç½®ã€å‚³è¼¸æ¨¡å¼ã€æ¶ˆæ¯å”è­°ã€API æ“ä½œã€‚">
    <meta property="og:site_name" content="Aspose MCP Server">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://xjustloveux.github.io/aspose-mcp-server/extensions.html">
    <meta property="twitter:title" content="æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å— - Aspose MCP Server">
    <meta property="twitter:description" content="Aspose MCP Server æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å—ï¼šæ“´å……åŠŸèƒ½é…ç½®ã€å‚³è¼¸æ¨¡å¼ã€æ¶ˆæ¯å”è­°ã€API æ“ä½œã€‚">
    <link rel="stylesheet" href="theme.css">
    <script src="theme.js"></script>
    <style>
        /* Page-specific styles */
        .feature-list {
            list-style: none;
            padding-left: 0;
        }

        .feature-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }

        .feature-list li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: var(--accent-primary);
            font-weight: bold;
            font-size: 1.2em;
        }

        .message-type {
            background: var(--bg-step);
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid var(--accent-primary);
        }

        .message-type h4 {
            margin: 0 0 10px 0;
            color: var(--accent-primary);
        }

        .message-type code {
            background: var(--bg-hover);
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* Page-specific RWD */
        @media (max-width: 768px) {
            .message-type {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
<nav>
    <div class="nav-container">
        <div class="nav-header">
            <a href="index.html" class="nav-logo"><img src="favicon.svg" alt="Aspose MCP Server"> Aspose MCP Server</a>
            <ul class="nav-menu" id="navMenu">
                <li>
                    <a href="index.html">é¦–é </a>
                </li>
                <li>
                    <a href="features.html">åŠŸèƒ½ç‰¹æ€§</a>
                </li>
                <li>
                    <a href="tools.html">å·¥å…·åˆ—è¡¨</a>
                </li>
                <li>
                    <a href="getting-started.html">å¿«é€Ÿé–‹å§‹</a>
                </li>
                <li>
                    <a href="developers.html">é–‹ç™¼è€…æŒ‡å—</a>
                </li>
                <li>
                    <a href="extensions.html" class="active">æ“´å……åŠŸèƒ½é–‹ç™¼</a>
                </li>
                <li>
                    <a href="configuration.html">é…ç½®åƒè€ƒ</a>
                </li>
                <li>
                    <a href="deployment.html">éƒ¨ç½²æŒ‡å—</a>
                </li>
                <li>
                    <a href="faq.html">å¸¸è¦‹å•ç­”</a>
                </li>
            </ul>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="åˆ‡æ›äº®/æš—è‰²ä¸»é¡Œ">ğŸŒ™</button>
            <button class="menu-toggle" aria-label="Toggle menu">â˜°</button>
        </div>
    </div>
</nav>

<div class="page-header">
    <div class="container">
        <h1>ğŸ”Œ æ“´å……åŠŸèƒ½é–‹ç™¼æŒ‡å—</h1>
        <p>äº†è§£å¦‚ä½•é–‹ç™¼æ“´å±•ç¨‹åºè¨‚é–± Session è®Šæ›´</p>
    </div>
</div>

<div class="container">
<div class="section">
    <h2>ğŸ“‹ æ¦‚è¿°</h2>
    <p>æ“´å……åŠŸèƒ½ç³»çµ±è®“å¤–éƒ¨ç¨‹åºè¨‚é–± Aspose MCP Server çš„ Session è®Šæ›´äº‹ä»¶ã€‚ç•¶ Session ä¸­çš„æ–‡ä»¶è¢«ä¿®æ”¹æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•å°‡æ–‡ä»¶å¿«ç…§ç™¼é€çµ¦å·²ç¶å®šçš„æ“´å……åŠŸèƒ½ç¨‹åºï¼Œé–‹ç™¼è€…å¯æ“šæ­¤å¯¦ç¾å„ç¨®è‡ªè¨‚æ‡‰ç”¨ã€‚</p>

    <h3>ç³»çµ±æ¶æ§‹</h3>
    <div class="code-wrapper">
        <pre class="code-block">ä¼ºæœå™¨å•Ÿå‹• â†’ è¼‰å…¥æ“´å±•é…ç½® â†’ MCP å°±ç·’
                 â†“
         èƒŒæ™¯åˆå§‹åŒ–ï¼ˆç•°æ­¥ï¼‰
                 â†“
         å•Ÿå‹•æ‰€æœ‰æ“´å±•ç¨‹åº â†’ æ¡æ‰‹äº¤æ›å…ƒè³‡æ–™
                                    â†“
MCP Client â†’ extension(bind) â†’ ExtensionSessionBridge â†â”€â”˜
                                    â†“
Session è®Šæ›´ â†’ DocumentConversionService â†’ å¿«ç…§
                                    â†“
                    Extension Process (Node.js/Python/etc.)
                                    â†“
                         æ¥æ”¶å¿«ç…§ â†’ è™•ç† â†’ å›æ‡‰ ACK</pre>
    </div>

    <h3>ç”Ÿå‘½é€±æœŸ</h3>
    <ul class="feature-list">
        <li><strong>å•Ÿå‹•éšæ®µ</strong>ï¼šä¼ºæœå™¨å•Ÿå‹•æ™‚æœƒåœ¨èƒŒæ™¯ç•°æ­¥åˆå§‹åŒ–æ“´å±•ï¼ˆä¸é˜»å¡ MCP ä¼ºæœå™¨å•Ÿå‹•ï¼‰ï¼Œåˆå§‹åŒ–éç¨‹ä¸­æ“´å±•è™•æ–¼ <code>Initializing</code> ç‹€æ…‹</li>
        <li><strong>åˆå§‹åŒ–ä¸­</strong>ï¼šæ“´å±•æ­£åœ¨åŸ·è¡Œæ¡æ‰‹å”è­°ï¼Œæ­¤æ™‚ç„¡æ³•ç¶å®š Sessionï¼Œéœ€ç­‰å¾…åˆå§‹åŒ–å®Œæˆ</li>
        <li><strong>é‹ä½œéšæ®µ</strong>ï¼šæ¡æ‰‹å®Œæˆå¾Œæ“´å±•é€²å…¥ <code>Idle</code> ç‹€æ…‹ï¼Œå¯é€éç¶å®šæ¥æ”¶ Session å¿«ç…§ï¼Œè™•ç†å¾Œå›æ‡‰ ACK</li>
        <li><strong>é–’ç½®ç®¡ç†</strong>ï¼šéå¸¸é§æ“´å±•ï¼ˆidleTimeoutMinutes &gt; 0ï¼‰åœ¨é–’ç½®è¶…æ™‚å¾Œè‡ªå‹•é—œé–‰</li>
        <li><strong>å¸¸é§æ¨¡å¼</strong>ï¼šè¨­å®š idleTimeoutMinutes = 0 çš„æ“´å±•æ°¸é ä¿æŒé‹ä½œ</li>
    </ul>
</div>

<div class="section">
    <h2>ğŸ’¡ é©ç”¨å ´æ™¯</h2>
    <p>ä»¥ä¸‹æ˜¯é–‹ç™¼è€…å¯é€éæ“´å……åŠŸèƒ½ç³»çµ±å¯¦ç¾çš„æ‡‰ç”¨æ–¹å‘ï¼š</p>

    <h3>é è¦½èˆ‡å‘ˆç¾</h3>
    <ul class="feature-list">
        <li><strong>åœ–ç‰‡/HTML é è¦½</strong> - å°‡æ–‡ä»¶å¿«ç…§è½‰æ›ç‚ºåœ–ç‰‡æˆ– HTMLï¼Œæ•´åˆè‡³ç·¨è¼¯å™¨æˆ–ç¶²é æ‡‰ç”¨</li>
        <li><strong>åˆ—å°æœå‹™</strong> - è‡ªå‹•åŒ–åˆ—å°å·¥ä½œæµç¨‹ï¼Œæ”¯æ´æ‰¹æ¬¡åˆ—å°æˆ–æ¢ä»¶è§¸ç™¼åˆ—å°</li>
    </ul>

    <h3>å®‰å…¨èˆ‡åˆè¦</h3>
    <ul class="feature-list">
        <li><strong>åˆè¦æª¢æŸ¥</strong> - è‡ªå‹•æª¢æŸ¥æ–‡ä»¶å…§å®¹æ˜¯å¦ç¬¦åˆæ³•è¦æˆ–ä¼æ¥­è¦ç¯„ï¼ˆGDPRã€HIPAA ç­‰ï¼‰</li>
        <li><strong>æ•¸ä½ç°½ç« </strong> - æ•´åˆæ•¸ä½ç°½ç« æœå‹™ï¼Œå¯¦ç¾æ–‡ä»¶é›»å­ç°½æ ¸</li>
        <li><strong>æ•æ„Ÿè³‡æ–™åµæ¸¬/é®è”½</strong> - è‡ªå‹•åµæ¸¬ä¸¦é®è”½å€‹è³‡ã€ä¿¡ç”¨å¡è™Ÿç­‰æ•æ„Ÿè³‡è¨Š</li>
        <li><strong>å¯©è¨ˆæ—¥èªŒ</strong> - è¨˜éŒ„æ‰€æœ‰æ–‡ä»¶è®Šæ›´æ­·ç¨‹ï¼Œç¬¦åˆæ³•è¦å¯©è¨ˆè¦æ±‚</li>
    </ul>

    <h3>å”ä½œèˆ‡æ•´åˆ</h3>
    <ul class="feature-list">
        <li><strong>å¤šäººå”ä½œç‹€æ…‹å»£æ’­</strong> - é€é WebSocket å»£æ’­æ–‡ä»¶è®Šæ›´ï¼Œå¯¦ç¾å³æ™‚å”ä½œ</li>
        <li><strong>é›²ç«¯/ERP/ç°½æ ¸æ•´åˆ</strong> - è‡ªå‹•åŒæ­¥è‡³é›²ç«¯ç©ºé–“ã€ERP ç³»çµ±æˆ–ç°½æ ¸æµç¨‹</li>
        <li><strong>é€šçŸ¥/è­¦å ±</strong> - æ–‡ä»¶è®Šæ›´æ™‚ç™¼é€ Emailã€Slackã€Teams ç­‰é€šçŸ¥</li>
    </ul>

    <h3>æ™ºæ…§è™•ç†</h3>
    <ul class="feature-list">
        <li><strong>AI æ‘˜è¦/ç¿»è­¯</strong> - æ•´åˆ LLM æœå‹™ï¼Œè‡ªå‹•ç”Ÿæˆæ‘˜è¦æˆ–ç¿»è­¯å…§å®¹</li>
        <li><strong>æ–‡æª”å°æ¯”</strong> - æ¯”è¼ƒæ–‡ä»¶ç‰ˆæœ¬å·®ç•°ï¼Œæ¨™ç¤ºè®Šæ›´å…§å®¹</li>
        <li><strong>ç„¡éšœç¤™è¼”åŠ©</strong> - æ–‡æª”æœ—è®€ã€åœ–ç‰‡ OCR è§£æï¼Œå”åŠ©è¦–éšœä½¿ç”¨è€…</li>
    </ul>

    <h3>è‡ªè¨‚è™•ç†</h3>
    <ul class="feature-list">
        <li><strong>æµ®æ°´å°/å“ç‰ŒåŒ–</strong> - åˆ†ç™¼å‰è‡ªå‹•åŠ å…¥æµ®æ°´å°æˆ–å…¬å¸æ¨™èªŒ</li>
        <li><strong>å®¢è£½åŒ–å†ç·¨è¼¯</strong> - å°æ–‡ä»¶å¿«ç…§é€²è¡Œè‡ªè¨‚è½‰æ›æˆ–å¾Œè™•ç†</li>
    </ul>
</div>

<div class="section">
    <h2>âš™ï¸ å•Ÿç”¨æ“´å……åŠŸèƒ½ç³»çµ±</h2>
    <p>æ“´å……åŠŸèƒ½ç³»çµ±éœ€è¦åŒæ™‚å•Ÿç”¨ Session åŠŸèƒ½ã€‚ä½¿ç”¨ä»¥ä¸‹åƒæ•¸å•Ÿç”¨ï¼š</p>

    <h3>å¿«é€Ÿå•Ÿå‹•</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block"># ç’°å¢ƒè®Šæ•¸
ASPOSE_SESSION_ENABLED=true
ASPOSE_EXTENSION_ENABLED=true
ASPOSE_EXTENSION_CONFIG=/path/to/extensions.json

# æˆ–å‘½ä»¤è¡Œåƒæ•¸
./AsposeMcpServer --http \
    --session-enabled \
    --extension-enabled \
    --extension-config ./extensions.json</pre>
    </div>

    <div class="info-box" style="margin-top: 15px;">
        <strong>ğŸ“– å®Œæ•´é…ç½®åƒè€ƒ</strong>
        <p style="margin-top: 8px; margin-bottom: 0;">
            å®Œæ•´çš„æ“´å……åŠŸèƒ½åƒæ•¸èªªæ˜è«‹åƒè€ƒ
            <a href="configuration.html#extension">
                <strong>é…ç½®åƒè€ƒ - æ“´å……åŠŸèƒ½è¨­å®š</strong>
            </a>ï¼ŒåŒ…å«æ‰€æœ‰ç³»çµ±ç´šè¨­å®šå’Œå¯è¦†å¯«è¨­å®šï¼ˆå« Floor/Ceiling ç´„æŸï¼‰ã€‚
        </p>
    </div>
</div>

<div class="section">
    <h2>ğŸ“„ æ“´å±•é…ç½®æª”æ¡ˆ</h2>
    <p>æ“´å±•é…ç½®æª”æ¡ˆï¼ˆextensions.jsonï¼‰å®šç¾©æ‰€æœ‰å·²è¨»å†Šçš„æ“´å±•ã€‚ä½¿ç”¨ç‰©ä»¶æ ¼å¼ï¼Œkey ä½œç‚ºæ“´å±•çš„å”¯ä¸€ IDã€‚</p>

    <h3>å®Œæ•´ç¯„ä¾‹</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "extensions": {
    "pdf-viewer": {
      "command": {
        "type": "node",
        "executable": "/path/to/index.js",
        "arguments": "--port 8080",
        "workingDirectory": "/path/to/extension",
        "environment": {
          "NODE_ENV": "production"
        }
      },
      "inputFormats": ["pdf"],
      "supportedDocumentTypes": ["word", "excel", "powerpoint", "pdf"],
      "transportModes": ["mmap", "stdin", "file"],
      "preferredTransportMode": "file",
      "capabilities": {
        "supportsHeartbeat": true,
        "frameIntervalMs": 100
      }
    },
    "cloud-sync": {
      "command": {
        "type": "python",
        "executable": "/path/to/main.py"
      },
      "inputFormats": ["pdf", "html"],
      "supportedDocumentTypes": ["word", "excel"],
      "transportModes": ["file"],
      "preferredTransportMode": "file",
      "capabilities": {
        "supportsHeartbeat": true,
        "idleTimeoutMinutes": 5
      }
    }
  }
}</pre>
    </div>

    <div class="info-box" style="margin-top: 15px;">
        <strong>ğŸ’¡ é…ç½®æ ¼å¼èªªæ˜</strong>
        <p style="margin-top: 8px; margin-bottom: 0;">
            é…ç½®æª”ä½¿ç”¨ç‰©ä»¶æ ¼å¼ï¼ˆè€Œéé™£åˆ—ï¼‰ï¼Œkey å³ç‚ºæ“´å±•çš„å”¯ä¸€ IDï¼ˆä¸å¯åŒ…å«å†’è™Ÿï¼‰ã€‚
            æ“´å±•çš„åç¨±ã€ç‰ˆæœ¬ç­‰å…ƒè³‡æ–™é€é<a href="#handshake">æ¡æ‰‹å”è­°</a>å‹•æ…‹äº¤æ›ï¼Œç„¡éœ€åœ¨é…ç½®æª”ä¸­æŒ‡å®šã€‚
        </p>
    </div>

    <h3>æ¬„ä½èªªæ˜</h3>
    <table class="tool-detail-table" style="margin-bottom: 15px;">
        <tr>
            <th style="width: 200px;">æ¬„ä½</th>
            <th>èªªæ˜</th>
        </tr>
        <tr>
            <td>
                <code>extensions.{id}</code>
            </td>
            <td>ç‰©ä»¶çš„ key ä½œç‚ºæ“´å±•å”¯ä¸€è­˜åˆ¥ç¬¦ï¼ˆä¸å¯åŒ…å«å†’è™Ÿï¼‰</td>
        </tr>
        <tr>
            <td>
                <code>command.type</code>
            </td>
            <td>å‘½ä»¤é¡å‹ï¼šexecutable / node / python / dotnet / npx / pipx / custom</td>
        </tr>
        <tr>
            <td>
                <code>command.executable</code>
            </td>
            <td>å¯åŸ·è¡Œæª”ã€è…³æœ¬è·¯å¾‘æˆ–å¥—ä»¶åç¨±ï¼ˆnpx/pipx æ™‚ç‚ºå¥—ä»¶åç¨±ï¼‰</td>
        </tr>
        <tr>
            <td>
                <code>command.arguments</code>
            </td>
            <td>å‘½ä»¤åˆ—åƒæ•¸</td>
        </tr>
        <tr>
            <td>
                <code>command.workingDirectory</code>
            </td>
            <td>å·¥ä½œç›®éŒ„</td>
        </tr>
        <tr>
            <td>
                <code>command.environment</code>
            </td>
            <td>ç’°å¢ƒè®Šæ•¸ï¼ˆæ”¯æ´ ${VAR} å¼•ç”¨ç³»çµ±ç’°å¢ƒè®Šæ•¸ï¼‰</td>
        </tr>
        <tr>
            <td>
                <code>inputFormats</code>
            </td>
            <td>æ¥å—çš„è¼¸å…¥æ ¼å¼é™£åˆ—ï¼špdf / html / png</td>
        </tr>
        <tr>
            <td>
                <code>supportedDocumentTypes</code>
            </td>
            <td>æ”¯æ´çš„æ–‡æª”é¡å‹ï¼šword / excel / powerpoint / pdf</td>
        </tr>
        <tr>
            <td>
                <code>transportModes</code>
            </td>
            <td>æ”¯æ´çš„å‚³è¼¸æ¨¡å¼é™£åˆ—ï¼šmmap / stdin / file</td>
        </tr>
        <tr>
            <td>
                <code>preferredTransportMode</code>
            </td>
            <td>åå¥½çš„å‚³è¼¸æ¨¡å¼</td>
        </tr>
        <tr>
            <td>
                <code>capabilities.supportsHeartbeat</code>
            </td>
            <td>æ˜¯å¦æ”¯æ´å¿ƒè·³æª¢æ¸¬</td>
        </tr>
        <tr>
            <td>
                <code>capabilities.frameIntervalMs</code>
            </td>
            <td>å¿«ç…§å‚³è¼¸é–“éš”æ¯«ç§’æ•¸ï¼ˆé è¨­ï¼š100ï¼Œç¯„åœï¼š10-5000ï¼‰</td>
        </tr>
        <tr>
            <td>
                <code>capabilities.snapshotTtlSeconds</code>
            </td>
            <td>æœªç¢ºèªå¿«ç…§çš„ TTL ç§’æ•¸ï¼ˆé è¨­ï¼š30ï¼Œç¯„åœï¼š5-300ï¼‰</td>
        </tr>
        <tr>
            <td>
                <code>capabilities.maxMissedHeartbeats</code>
            </td>
            <td>æœ€å¤§é€£çºŒå¿ƒè·³å¤±æ•—æ¬¡æ•¸ï¼ˆé è¨­ï¼š3ï¼Œç¯„åœï¼š1-20ï¼‰</td>
        </tr>
        <tr>
            <td>
                <code>capabilities.idleTimeoutMinutes</code>
            </td>
            <td>é–’ç½®å¸è¼‰è¶…æ™‚åˆ†é˜æ•¸ï¼ˆé è¨­ï¼š30ï¼Œç¯„åœï¼š1-1440ï¼Œ0=å¸¸é§æ¨¡å¼ï¼‰</td>
        </tr>
    </table>
</div>

<div class="section" id="handshake">
    <h2>ğŸ¤ æ¡æ‰‹å”è­°</h2>
    <p>æ‰€æœ‰æ“´å±•åœ¨æœå‹™å•Ÿå‹•å¾Œæœƒåœ¨èƒŒæ™¯ç•°æ­¥å•Ÿå‹•ï¼Œä¸¦åŸ·è¡Œåˆå§‹åŒ–æ¡æ‰‹ã€‚é€éæ¡æ‰‹ï¼Œæ“´å±•æœƒå›å ±è‡ªå·±çš„åç¨±ã€ç‰ˆæœ¬ç­‰å…ƒè³‡æ–™ã€‚æ¡æ‰‹æœŸé–“æ“´å±•è™•æ–¼ <code>Initializing</code> ç‹€æ…‹ï¼Œæ­¤æ™‚ç„¡æ³•é€²è¡Œç¶å®šæ“ä½œã€‚</p>

    <h3>æ¡æ‰‹æµç¨‹</h3>
    <div class="code-wrapper">
        <pre class="code-block">MCP Server                                    Extension
    â”‚                                              â”‚
    â”‚  1. å•Ÿå‹•æ“´å±•ç¨‹åº                              â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
    â”‚                                              â”‚
    â”‚  2. {"type":"initialize","protocolVersion":"1.0"}
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
    â”‚                                              â”‚
    â”‚  3. {"type":"initialize_response","name":"...","version":"..."}
    â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                              â”‚
    â”‚  4. {"type":"initialized"}                   â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
    â”‚                                              â”‚
    â”‚  æ¡æ‰‹å®Œæˆï¼Œé–‹å§‹æ­£å¸¸é‹ä½œ                        â”‚</pre>
    </div>

    <h3>æ¡æ‰‹æ¶ˆæ¯</h3>

    <div class="message-type">
        <h4>initializeï¼ˆMCP Server â†’ Extensionï¼‰</h4>
        <p>ä¼ºæœå™¨ç™¼é€çµ¦æ“´å±•ï¼Œå•Ÿå‹•æ¡æ‰‹æµç¨‹ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "type": "initialize",
  "protocolVersion": "1.0"
}</pre>
        </div>
    </div>

    <div class="message-type">
        <h4>initialize_responseï¼ˆExtension â†’ MCP Serverï¼‰</h4>
        <p>æ“´å±•å›æ‡‰å…¶å…ƒè³‡æ–™ã€‚<code>name</code> å’Œ <code>version</code> ç‚ºå¿…å¡«æ¬„ä½ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "type": "initialize_response",
  "name": "PDF Viewer",
  "version": "1.0.0",
  "title": "PDF å³æ™‚é è¦½å™¨",
  "description": "æä¾› PDF æ–‡ä»¶çš„å³æ™‚é è¦½åŠŸèƒ½",
  "author": "é–‹ç™¼è€…åç¨±",
  "websiteUrl": "https://example.com"
}</pre>
        </div>
        <table class="tool-detail-table" style="margin-top: 15px;">
            <tr>
                <th style="width: 150px;">æ¬„ä½</th>
                <th style="width: 80px;">å¿…å¡«</th>
                <th>èªªæ˜</th>
            </tr>
            <tr>
                <td>
                    <code>name</code>
                </td>
                <td>æ˜¯</td>
                <td>æ“´å±•é¡¯ç¤ºåç¨±</td>
            </tr>
            <tr>
                <td>
                    <code>version</code>
                </td>
                <td>æ˜¯</td>
                <td>ç‰ˆæœ¬è™Ÿï¼ˆå»ºè­°ä½¿ç”¨ semver æ ¼å¼ï¼‰</td>
            </tr>
            <tr>
                <td>
                    <code>title</code>
                </td>
                <td>å¦</td>
                <td>æœ¬åœ°åŒ–æ¨™é¡Œï¼ˆç”¨æ–¼ UI é¡¯ç¤ºï¼‰</td>
            </tr>
            <tr>
                <td>
                    <code>description</code>
                </td>
                <td>å¦</td>
                <td>æ“´å±•åŠŸèƒ½èªªæ˜</td>
            </tr>
            <tr>
                <td>
                    <code>author</code>
                </td>
                <td>å¦</td>
                <td>ä½œè€…è³‡è¨Š</td>
            </tr>
            <tr>
                <td>
                    <code>websiteUrl</code>
                </td>
                <td>å¦</td>
                <td>æ“´å±•ç¶²ç«™æˆ–æ–‡æª” URL</td>
            </tr>
        </table>
    </div>

    <div class="message-type">
        <h4>initializedï¼ˆMCP Server â†’ Extensionï¼‰</h4>
        <p>ä¼ºæœå™¨ç¢ºèªæ¡æ‰‹å®Œæˆã€‚æ”¶åˆ°æ­¤æ¶ˆæ¯å¾Œï¼Œæ“´å±•å¯é–‹å§‹æ­£å¸¸è™•ç†å¿«ç…§ç­‰æ¶ˆæ¯ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "type": "initialized"
}</pre>
        </div>
    </div>

    <h3>æ¡æ‰‹å¤±æ•—è™•ç†</h3>
    <ul class="feature-list">
        <li>æ¡æ‰‹è¶…æ™‚ï¼ˆé è¨­ 30 ç§’ï¼‰ï¼šæ“´å±•è¢«æ¨™è¨˜ç‚ºä¸å¯ç”¨</li>
        <li>ç¼ºå°‘å¿…å¡«æ¬„ä½ï¼ˆname æˆ– versionï¼‰ï¼šæ¡æ‰‹å¤±æ•—ï¼Œæ“´å±•è¢«æ¨™è¨˜ç‚ºä¸å¯ç”¨</li>
        <li>æ“´å±•ç¨‹åºå•Ÿå‹•å¤±æ•—ï¼šæ“´å±•è¢«æ¨™è¨˜ç‚ºä¸å¯ç”¨ï¼Œè¨˜éŒ„éŒ¯èª¤åŸå› </li>
    </ul>
</div>

<div class="section">
    <h2>ğŸšš å‚³è¼¸æ¨¡å¼</h2>
    <p>æ“´å……åŠŸèƒ½ç³»çµ±æ”¯æ´ä¸‰ç¨®å‚³è¼¸æ¨¡å¼ï¼Œç”¨æ–¼å°‡å¿«ç…§è³‡æ–™ç™¼é€çµ¦æ“´å……åŠŸèƒ½ç¨‹åºï¼š</p>

    <div class="message-type">
        <h4>mmap (Memory-Mapped File)</h4>
        <p>ä½¿ç”¨è¨˜æ†¶é«”æ˜ å°„æª”æ¡ˆå‚³è¼¸è³‡æ–™ã€‚è·¨å¹³å°æ”¯æ´ï¼Œæ•ˆèƒ½æœ€ä½³ã€‚</p>
        <ul>
            <li><strong>Windows</strong>ï¼šä½¿ç”¨ Windows å…§æ ¸å‘½åå…±äº«è¨˜æ†¶é«”</li>
            <li><strong>Linux</strong>ï¼šä½¿ç”¨ POSIX shm_open (/dev/shm/)</li>
            <li><strong>macOS</strong>ï¼šä½¿ç”¨æª”æ¡ˆæ”¯æŒçš„è¨˜æ†¶é«”æ˜ å°„ï¼ˆè‡ªå‹•é™ç´šï¼‰</li>
            <li><strong>å„ªé»</strong>ï¼šé›¶æ‹·è²ï¼ˆWindows/Linuxï¼‰ï¼Œé«˜æ•ˆèƒ½</li>
            <li><strong>é©ç”¨å ´æ™¯</strong>ï¼šå¤§å‹æ–‡ä»¶é è¦½ï¼Œéœ€è¦æœ€ä½³æ•ˆèƒ½æ™‚</li>
        </ul>
    </div>

    <div class="message-type">
        <h4>stdin (Standard Input) - é è¨­</h4>
        <p>é€éæ¨™æº–è¼¸å…¥ç™¼é€äºŒé€²ä½è³‡æ–™ã€‚è·¨å¹³å°ç›¸å®¹ï¼Œç„¡ç£ç¢Ÿ I/O é–‹éŠ·ã€‚</p>
        <ul>
            <li><strong>å„ªé»</strong>ï¼šè·¨å¹³å°ã€ä½å»¶é²ã€ç„¡éœ€æš«å­˜æª”</li>
            <li><strong>ç¼ºé»</strong>ï¼šéœ€è¦è™•ç†äºŒé€²ä½ä¸²æµ</li>
            <li><strong>é©ç”¨å ´æ™¯</strong>ï¼šå¤§å¤šæ•¸å ´æ™¯ï¼ˆé è¨­ï¼‰</li>
        </ul>
    </div>

    <div class="message-type">
        <h4>file (Temporary File)</h4>
        <p>å°‡å¿«ç…§å¯«å…¥è‡¨æ™‚æª”æ¡ˆï¼Œé€éè·¯å¾‘å‚³éçµ¦æ“´å±•ã€‚å¯¦ä½œæœ€ç°¡å–®ã€‚</p>
        <ul>
            <li><strong>å„ªé»</strong>ï¼šå¯¦ä½œç°¡å–®ï¼Œæ”¯æ´æ‰€æœ‰èªè¨€</li>
            <li><strong>ç¼ºé»</strong>ï¼šéœ€è¦ç£ç¢Ÿ I/O</li>
            <li><strong>é©ç”¨å ´æ™¯</strong>ï¼šç°¡å–®æ•´åˆã€é™¤éŒ¯æ¸¬è©¦</li>
        </ul>
    </div>
</div>

<div class="section">
    <h2>ğŸ“¨ æ¶ˆæ¯å”è­°</h2>
    <p>æ“´å±•ç¨‹åºé€éæ¨™æº–è¼¸å…¥è¼¸å‡ºèˆ‡ MCP Server é€šè¨Šã€‚æ¶ˆæ¯æ ¼å¼ç‚º JSONï¼Œæ¯è¡Œä¸€æ¢æ¶ˆæ¯ã€‚</p>

    <div class="info-box" style="margin-bottom: 20px;">
        <strong>ğŸ’¡ æ¡æ‰‹æ¶ˆæ¯</strong>
        <p style="margin-top: 8px; margin-bottom: 0;">
            æ“´å±•å•Ÿå‹•æ™‚å¿…é ˆå…ˆå®Œæˆ<a href="#handshake">æ¡æ‰‹å”è­°</a>ï¼ˆinitialize â†’ initialize_response â†’ initializedï¼‰ï¼Œæ‰æœƒæ”¶åˆ°ä»¥ä¸‹æ¶ˆæ¯ã€‚
        </p>
    </div>

    <h3>MCP Server â†’ æ“´å……åŠŸèƒ½ æ¶ˆæ¯</h3>

    <div class="message-type">
        <h4>snapshot</h4>
        <p>æ–‡ä»¶å¿«ç…§æ¶ˆæ¯ï¼ŒåŒ…å«è½‰æ›å¾Œçš„æ–‡ä»¶è³‡æ–™ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "protocolVersion": "1.0",
  "type": "snapshot",
  "sessionId": "sess_abc123",
  "documentType": "word",
  "outputFormat": "pdf",
  "mimeType": "application/pdf",
  "transportMode": "file",
  "filePath": "/tmp/extensions/snapshot_xxx.pdf",
  "dataSize": 12345,
  "checksum": 1234567890,
  "sequenceNumber": 1,
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
        </div>
    </div>

    <div class="message-type">
        <h4>heartbeat</h4>
        <p>å¿ƒè·³æª¢æ¸¬æ¶ˆæ¯ï¼Œç”¨æ–¼ç¢ºèªæ“´å±•å­˜æ´»ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "protocolVersion": "1.0",
  "type": "heartbeat",
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
        </div>
    </div>

    <div class="message-type">
        <h4>command</h4>
        <p>å‘½ä»¤æ¶ˆæ¯ï¼Œç”± MCP å®¢æˆ¶ç«¯ç™¼é€çµ¦æ“´å±•ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "protocolVersion": "1.0",
  "type": "command",
  "sessionId": "sess_abc123",
  "commandId": "cmd_abc123",
  "commandType": "highlight",
  "commandPayload": { "text": "important" },
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
        </div>
    </div>

    <div class="message-type">
        <h4>session_closed</h4>
        <p>Session é—œé–‰æ¶ˆæ¯ï¼Œé€šçŸ¥æ“´å±•åœæ­¢è™•ç†è©² Session ä¸¦æ¸…ç†è³‡æºã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "protocolVersion": "1.0",
  "type": "session_closed",
  "sessionId": "sess_abc123",
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
        </div>
    </div>

    <div class="message-type">
        <h4>session_unbound</h4>
        <p>Session è§£é™¤ç¶å®šæ¶ˆæ¯ï¼Œé€šçŸ¥æ“´å±•è©² Session ä¸å†ç¶å®šåˆ°æ­¤æ“´å±•ï¼ˆä½† Session ä»å­˜åœ¨ï¼‰ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "protocolVersion": "1.0",
  "type": "session_unbound",
  "sessionId": "sess_abc123",
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
        </div>
    </div>

    <h3>æ“´å……åŠŸèƒ½ â†’ MCP Server æ¶ˆæ¯</h3>

    <div class="message-type">
        <h4>ack</h4>
        <p>å¿«ç…§ç¢ºèªæ¶ˆæ¯ï¼Œè¡¨ç¤ºå·²æˆåŠŸæ¥æ”¶ä¸¦è™•ç†å¿«ç…§ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "type": "ack",
  "sessionId": "sess_abc123",
  "sequenceNumber": 1,
  "success": true
}</pre>
        </div>
    </div>

    <div class="message-type">
        <h4>heartbeat_response</h4>
        <p>å¿ƒè·³å›æ‡‰æ¶ˆæ¯ã€‚</p>
        <div class="code-wrapper">
            <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
            <pre class="code-block">{
  "type": "heartbeat_response",
  "status": "ok",
  "timestamp": "2024-01-01T12:00:00Z"
}</pre>
        </div>
    </div>
</div>

<div class="section">
    <h2>ğŸ”§ æ“´å……åŠŸèƒ½å·¥å…·æ“ä½œ</h2>
    <p>MCP å®¢æˆ¶ç«¯å¯é€é <code>extension</code> å·¥å…·ç®¡ç†æ“´å±•å’Œç¶å®šã€‚</p>

    <h3>list - åˆ—å‡ºæ‰€æœ‰æ“´å±•</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "list"
}</pre>
    </div>

    <h3>bind - ç¶å®š Session åˆ°æ“´å±•</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "bind",
  "sessionId": "abc123",
  "extensionId": "pdf-viewer",
  "format": "pdf"
}</pre>
    </div>

    <h3>unbind - è§£é™¤ç¶å®š</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "unbind",
  "sessionId": "abc123",
  "extensionId": "pdf-viewer"
}</pre>
    </div>

    <h3>status - æŸ¥è©¢æ“´å±•ç‹€æ…‹</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "status",
  "extensionId": "pdf-viewer"
}</pre>
    </div>

    <h3>set_format - è¨­å®šå¿«ç…§æ ¼å¼</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "set_format",
  "sessionId": "abc123",
  "extensionId": "pdf-viewer",
  "format": "html"
}</pre>
    </div>

    <h3>bindings - åˆ—å‡º Session ç¶å®š</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "bindings",
  "sessionId": "abc123"
}</pre>
    </div>

    <h3>command - ç™¼é€å‘½ä»¤çµ¦æ“´å±•</h3>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "operation": "command",
  "sessionId": "abc123",
  "extensionId": "pdf-viewer",
  "command": "goto",
  "data": { "page": 5 }
}</pre>
    </div>
</div>

<div class="section">
<h2>ğŸ’» é–‹ç™¼ç¯„ä¾‹</h2>

<h3>Node.js æ“´å±•ç¯„ä¾‹</h3>
<div class="code-wrapper">
    <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
    <pre class="code-block">const readline = require('readline');

let initialized = false;

const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
    terminal: false
});

rl.on('line', (line) => {
    try {
        const message = JSON.parse(line);
        const msgType = message.type;

        switch (msgType) {
            // ===== æ¡æ‰‹å”è­° =====
            case 'initialize':
                // å›æ‡‰æ¡æ‰‹ï¼Œæä¾›æ“´å±•å…ƒè³‡æ–™
                const initResponse = {
                    type: 'initialize_response',
                    name: 'My Extension',
                    version: '1.0.0',
                    title: 'æˆ‘çš„æ“´å±•åŠŸèƒ½',
                    description: 'æä¾›è‡ªè¨‚æ–‡ä»¶è™•ç†åŠŸèƒ½',
                    author: 'é–‹ç™¼è€…åç¨±',
                    websiteUrl: 'https://example.com'
                };
                console.log(JSON.stringify(initResponse));
                console.error('Handshake: sent initialize_response');
                break;

            case 'initialized':
                // æ¡æ‰‹å®Œæˆï¼Œé–‹å§‹æ­£å¸¸é‹ä½œ
                initialized = true;
                console.error('Handshake completed, ready to receive messages');
                break;

            // ===== æ­£å¸¸é‹ä½œæ¶ˆæ¯ =====
            case 'snapshot':
                if (!initialized) {
                    console.error('Warning: received snapshot before initialization');
                    return;
                }
                // è™•ç†å¿«ç…§
                console.error(`Received snapshot for session ${message.sessionId}`);
                console.error(`File: ${message.filePath}, Size: ${message.dataSize}`);

                // é©—è­‰ checksumï¼ˆå¯é¸ä½†å»ºè­°ï¼‰
                // const data = fs.readFileSync(message.filePath);
                // if (crc32(data) !== message.checksum) { /* è™•ç†éŒ¯èª¤ */ }

                // ç™¼é€ ACK
                const ack = {
                    type: 'ack',
                    sessionId: message.sessionId,
                    sequenceNumber: message.sequenceNumber,
                    success: true
                };
                console.log(JSON.stringify(ack));
                break;

            case 'heartbeat':
                // å›æ‡‰å¿ƒè·³
                const response = {
                    type: 'heartbeat_response',
                    status: 'ok',
                    timestamp: new Date().toISOString()
                };
                console.log(JSON.stringify(response));
                break;

            case 'command':
                // è™•ç†å‘½ä»¤
                console.error(`Received command: ${message.commandType}`);
                console.error(`Payload: ${JSON.stringify(message.commandPayload)}`);
                break;

            case 'session_closed':
                // æ¸…ç† Session è³‡æº
                console.error(`Session ${message.sessionId} closed`);
                break;

            case 'session_unbound':
                // Session è§£é™¤ç¶å®šï¼ˆSession ä»å­˜åœ¨ï¼Œä½†ä¸å†ç¶å®šåˆ°æ­¤æ“´å±•ï¼‰
                console.error(`Session ${message.sessionId} unbound`);
                break;

            case 'shutdown':
                // æº–å‚™é—œé–‰
                console.error('Shutdown requested');
                process.exit(0);
                break;
        }
    } catch (error) {
        console.error('Error processing message:', error);
    }
});

console.error('Extension started, waiting for handshake...');</pre>
</div>

<h3>Python æ“´å±•ç¯„ä¾‹</h3>
<div class="code-wrapper">
    <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
    <pre class="code-block">import sys
import json
from datetime import datetime

initialized = False

def main():
    global initialized
    print("Extension started, waiting for handshake...", file=sys.stderr)

    for line in sys.stdin:
        try:
            message = json.loads(line.strip())
            msg_type = message.get('type')

            # ===== æ¡æ‰‹å”è­° =====
            if msg_type == 'initialize':
                # å›æ‡‰æ¡æ‰‹ï¼Œæä¾›æ“´å±•å…ƒè³‡æ–™
                init_response = {
                    'type': 'initialize_response',
                    'name': 'My Extension',
                    'version': '1.0.0',
                    'title': 'æˆ‘çš„æ“´å±•åŠŸèƒ½',
                    'description': 'æä¾›è‡ªè¨‚æ–‡ä»¶è™•ç†åŠŸèƒ½',
                    'author': 'é–‹ç™¼è€…åç¨±',
                    'websiteUrl': 'https://example.com'
                }
                print(json.dumps(init_response))
                sys.stdout.flush()
                print("Handshake: sent initialize_response", file=sys.stderr)

            elif msg_type == 'initialized':
                # æ¡æ‰‹å®Œæˆï¼Œé–‹å§‹æ­£å¸¸é‹ä½œ
                initialized = True
                print("Handshake completed, ready to receive messages", file=sys.stderr)

            # ===== æ­£å¸¸é‹ä½œæ¶ˆæ¯ =====
            elif msg_type == 'snapshot':
                if not initialized:
                    print("Warning: received snapshot before initialization", file=sys.stderr)
                    continue
                # è™•ç†å¿«ç…§
                session_id = message['sessionId']
                file_path = message['filePath']
                data_size = message['dataSize']
                seq_num = message['sequenceNumber']
                print(f"Received snapshot: {file_path} ({data_size} bytes)", file=sys.stderr)

                # é©—è­‰ checksumï¼ˆå¯é¸ä½†å»ºè­°ï¼‰
                # checksum = message['checksum']
                # with open(file_path, 'rb') as f:
                #     if crc32(f.read()) != checksum: handle_error()

                # ç™¼é€ ACK
                ack = {
                    'type': 'ack',
                    'sessionId': session_id,
                    'sequenceNumber': seq_num,
                    'success': True
                }
                print(json.dumps(ack))
                sys.stdout.flush()

            elif msg_type == 'heartbeat':
                # å›æ‡‰å¿ƒè·³
                response = {
                    'type': 'heartbeat_response',
                    'status': 'ok',
                    'timestamp': datetime.utcnow().isoformat() + 'Z'
                }
                print(json.dumps(response))
                sys.stdout.flush()

            elif msg_type == 'command':
                # è™•ç†å‘½ä»¤
                cmd_type = message.get('commandType')
                payload = message.get('commandPayload', {})
                print(f"Received command: {cmd_type}, payload: {payload}", file=sys.stderr)

            elif msg_type == 'session_closed':
                # æ¸…ç†è³‡æº
                print(f"Session {message['sessionId']} closed", file=sys.stderr)

            elif msg_type == 'session_unbound':
                # Session è§£é™¤ç¶å®šï¼ˆSession ä»å­˜åœ¨ï¼Œä½†ä¸å†ç¶å®šåˆ°æ­¤æ“´å±•ï¼‰
                print(f"Session {message['sessionId']} unbound", file=sys.stderr)

            elif msg_type == 'shutdown':
                # æº–å‚™é—œé–‰
                print("Shutdown requested", file=sys.stderr)
                sys.exit(0)

        except json.JSONDecodeError as e:
            print(f"JSON parse error: {e}", file=sys.stderr)
        except Exception as e:
            print(f"Error: {e}", file=sys.stderr)

if __name__ == '__main__':
    main()</pre>
</div>
</div>

<div class="section">
    <h2>ğŸ¯ å¯¦éš›ç¯„ä¾‹ï¼šaspose-mcp-preview</h2>
    <p>
        <a href="https://github.com/xjustloveux/aspose-mcp-preview" target="_blank">
            <strong>aspose-mcp-preview</strong>
        </a>
        æ˜¯ä¸€å€‹å®Œæ•´çš„æ“´å……åŠŸèƒ½å¯¦ä½œç¯„ä¾‹ï¼Œæä¾›å³æ™‚æ–‡æª”é è¦½åŠŸèƒ½ã€‚é€é WebSocket å³æ™‚æ›´æ–°ï¼Œè®“ MCP å®¢æˆ¶ç«¯åœ¨ç·¨è¼¯æ–‡æª”æ™‚å¯åŒæ­¥åœ¨ç€è¦½å™¨ä¸­æŸ¥çœ‹ PNGã€HTML æˆ– PDF é è¦½ã€‚
    </p>

    <h3>åŠŸèƒ½å±•ç¤º</h3>
    <div style="text-align: center; margin: 20px 0;">
        <img src="images/aspose-mcp-preview-demo.gif" alt="aspose-mcp-preview æ“ä½œå±•ç¤º" style="max-width: 100%; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
    </div>

    <h3>ä¸»è¦åŠŸèƒ½</h3>
    <ul class="feature-list">
        <li><strong>å³æ™‚é è¦½</strong> - é€é WebSocket å³æ™‚æ›´æ–°ï¼Œæ–‡æª”è®Šæ›´ç«‹å³åæ˜ åœ¨é è¦½ç•«é¢</li>
        <li><strong>å¤šæ ¼å¼æ”¯æ´</strong> - æ”¯æ´ Wordã€Excelã€PowerPointã€PDF æ–‡æª”é¡å‹</li>
        <li><strong>å¤šç¨®è¼¸å‡ºæ ¼å¼</strong> - å¯è¼¸å‡ºç‚º PNGã€HTMLã€PDF æ ¼å¼</li>
        <li><strong>å¤š Session ç®¡ç†</strong> - æ”¯æ´å¤šå€‹ Session åŒæ™‚é è¦½ï¼Œå¯å¿«é€Ÿåˆ‡æ›</li>
        <li><strong>ç¸®æ”¾æ§åˆ¶</strong> - è‡ªé©æ‡‰ã€100%ã€è‡ªè¨‚ç™¾åˆ†æ¯”ç­‰ç¸®æ”¾é¸é …</li>
        <li><strong>PDF é é¢å°è¦½</strong> - PDF æ–‡æª”æ”¯æ´é é¢åˆ‡æ›å°è¦½</li>
        <li><strong>ä¸»é¡Œåˆ‡æ›</strong> - æ”¯æ´äº®è‰²ã€æš—è‰²ã€è·Ÿéš¨ç³»çµ±ä¸»é¡Œ</li>
        <li><strong>é™¤éŒ¯æ—¥èªŒ</strong> - å¯æ”¶åˆçš„æ—¥èªŒé¢æ¿ï¼Œæ–¹ä¾¿é–‹ç™¼é™¤éŒ¯</li>
    </ul>

    <h3>å¿«é€Ÿå®‰è£</h3>
    <p>åœ¨ <code>extensions.json</code> ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š</p>
    <div class="code-wrapper">
        <button class="copy-button" onclick="copyCode(this)">ğŸ“‹ è¤‡è£½</button>
        <pre class="code-block">{
  "extensions": {
    "preview": {
      "command": {
        "type": "npx",
        "executable": "aspose-mcp-preview",
        "arguments": "--port 3000"
      },
      "inputFormats": ["png", "html", "pdf"],
      "supportedDocumentTypes": ["word", "excel", "powerpoint", "pdf"],
      "transportModes": ["stdin", "file", "mmap"],
      "preferredTransportMode": "stdin",
      "capabilities": {
        "supportsHeartbeat": true,
        "idleTimeoutMinutes": 0
      }
    }
  }
}</pre>
    </div>

    <h3>å‘½ä»¤åˆ—é¸é …</h3>
    <table class="tool-detail-table">
        <tr>
            <th style="width: 150px;">é¸é …</th>
            <th style="width: 100px;">é è¨­å€¼</th>
            <th>èªªæ˜</th>
        </tr>
        <tr>
            <td>
                <code>--port</code>
            </td>
            <td>3000</td>
            <td>Web ä¼ºæœå™¨é€£æ¥åŸ </td>
        </tr>
        <tr>
            <td>
                <code>--host</code>
            </td>
            <td>localhost</td>
            <td>Web ä¼ºæœå™¨ä¸»æ©Ÿåç¨±</td>
        </tr>
        <tr>
            <td>
                <code>--no-open</code>
            </td>
            <td>false</td>
            <td>å•Ÿå‹•æ™‚ä¸è‡ªå‹•é–‹å•Ÿç€è¦½å™¨</td>
        </tr>
        <tr>
            <td>
                <code>--transport</code>
            </td>
            <td>stdin</td>
            <td>å‚³è¼¸æ¨¡å¼ï¼šstdin / file / mmap</td>
        </tr>
    </table>

    <div class="info-box" style="margin-top: 20px;">
        <strong>ğŸ“¦ æ›´å¤šè³‡è¨Š</strong>
        <p style="margin-top: 8px; margin-bottom: 0;">
            å®Œæ•´æ–‡æª”ã€åŸå§‹ç¢¼èˆ‡æ›´æ–°è«‹åƒè€ƒ
            <a href="https://github.com/xjustloveux/aspose-mcp-preview" target="_blank">
                <strong>GitHub - aspose-mcp-preview</strong>
            </a>
        </p>
    </div>
</div>

<div class="section">
    <h2>ğŸ“ æœ€ä½³å¯¦è¸</h2>

    <h3>æ¡æ‰‹å”è­°</h3>
    <ul class="feature-list">
        <li>æ“´å±•å¿…é ˆåœ¨æ”¶åˆ° <code>initialize</code> å¾Œç›¡å¿«å›æ‡‰ <code>initialize_response</code></li>
        <li><code>name</code> å’Œ <code>version</code> æ¬„ä½ç‚ºå¿…å¡«ï¼Œå»ºè­°ç‰ˆæœ¬è™Ÿä½¿ç”¨ semver æ ¼å¼</li>
        <li>åœ¨æ”¶åˆ° <code>initialized</code> ä¹‹å‰ä¸è¦è™•ç†å…¶ä»–æ¶ˆæ¯</li>
        <li>æ¡æ‰‹è¶…æ™‚é è¨­ç‚º 30 ç§’ï¼Œè«‹ç¢ºä¿æ“´å±•èƒ½åœ¨æ­¤æ™‚é–“å…§å®Œæˆåˆå§‹åŒ–</li>
    </ul>

    <h3>éŒ¯èª¤è™•ç†</h3>
    <ul class="feature-list">
        <li>ä½¿ç”¨ stderr è¼¸å‡ºæ—¥èªŒå’ŒéŒ¯èª¤ï¼Œstdout åƒ…ç”¨æ–¼å”è­°æ¶ˆæ¯</li>
        <li>è™•ç† JSON è§£æéŒ¯èª¤ï¼Œé¿å…æ“´å±•å´©æ½°</li>
        <li>è¨­å®šé©ç•¶çš„è¶…æ™‚è™•ç†ï¼Œé¿å…é˜»å¡</li>
    </ul>

    <h3>æ•ˆèƒ½å„ªåŒ–</h3>
    <ul class="feature-list">
        <li>å„ªå…ˆä½¿ç”¨ stdin å‚³è¼¸æ¨¡å¼ï¼ˆé è¨­ï¼‰ï¼Œè·¨å¹³å°ä¸”ç„¡ç£ç¢Ÿ I/O é–‹éŠ·</li>
        <li>éœ€è¦æœ€ä½³æ•ˆèƒ½æ™‚å¯ä½¿ç”¨ mmap æ¨¡å¼ï¼ˆWindows/Linux é›¶æ‹·è²ï¼‰</li>
        <li>åŠæ™‚ç™¼é€ ACK ç¢ºèªï¼Œé¿å…é‡è©¦</li>
        <li>è¨­å®šåˆç†çš„ frameIntervalMs é…åˆæ“´å±•è™•ç†èƒ½åŠ›</li>
    </ul>

    <h3>å¯é æ€§</h3>
    <ul class="feature-list">
        <li>å•Ÿç”¨ supportsHeartbeat ä¿æŒé€£æ¥æ´»èº</li>
        <li>ç™¼é€ ACK ç¢ºèªå¿«ç…§é€é”ï¼Œé¿å…é‡è¤‡ç™¼é€</li>
        <li>è™•ç† session_closed æ¶ˆæ¯æ­£ç¢ºé‡‹æ”¾è³‡æº</li>
    </ul>
</div>

<div class="section">
    <h2>ğŸ”— ç›¸é—œè³‡æº</h2>
    <ul class="feature-list">
        <li>
            <a href="https://github.com/xjustloveux/aspose-mcp-preview" target="_blank">
                <strong>aspose-mcp-preview</strong>
            </a> - å³æ™‚æ–‡æª”é è¦½æ“´å……åŠŸèƒ½ï¼ˆå®Œæ•´å¯¦ä½œç¯„ä¾‹ï¼‰
        </li>
        <li>
            <a href="tools.html#extension-æ“´å……åŠŸèƒ½">æ“´å……åŠŸèƒ½å·¥å…·æ“ä½œæ–‡æª”</a>
        </li>
        <li>
            <a href="deployment.html">éƒ¨ç½²æŒ‡å— - æ“´å……åŠŸèƒ½é…ç½®</a>
        </li>
        <li>
            <a href="features.html">åŠŸèƒ½ç‰¹æ€§ - æ“´å……åŠŸèƒ½ç³»çµ±</a>
        </li>
        <li>
            <a href="https://github.com/xjustloveux/aspose-mcp-server/blob/master/extensions_example.json" target="_blank">
                <code>extensions_example.json</code>
            </a> - å®Œæ•´é…ç½®ç¯„ä¾‹
        </li>
    </ul>
</div>
</div>

<footer>
    <div class="container">
        <p>åŸºæ–¼ .NET 8.0ã€Aspose.Total 23.10.0 å’Œ MCP SDK 0.6.0 æ§‹å»º</p>
        <p class="footer-links" style="margin-top: 10px;">
            <a href="https://github.com/xjustloveux/aspose-mcp-server" target="_blank">GitHub</a> |
            <a href="https://www.aspose.com/" target="_blank">Aspose</a> |
            <a href="https://modelcontextprotocol.io/" target="_blank">MCP Protocol</a> |
            <a href="https://github.com/modelcontextprotocol/csharp-sdk" target="_blank">.NET MCP SDK</a>
        </p>
        <p class="copyright-text" style="margin-top: 20px; font-size: 0.9em;">
            Â© 2025 JaJa. All rights reserved. | MIT License
        </p>
    </div>
</footer>

<script>
    function copyCode(button) {
        const wrapper = button.parentElement;
        const codeBlock = wrapper.querySelector('.code-block');
        const text = codeBlock.textContent;

        navigator.clipboard.writeText(text).then(function() {
            button.textContent = 'âœ“ å·²è¤‡è£½';
            button.classList.add('copied');
            setTimeout(function() {
                button.textContent = 'ğŸ“‹ è¤‡è£½';
                button.classList.remove('copied');
            }, 2000);
        });
    }
</script>
</body>
</html>
