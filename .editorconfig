# EditorConfig: https://editorconfig.org
root = true

# All files
[*]
indent_style = space
indent_size = 4
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

# C# files
[*.cs]
indent_size = 4

# ===== Roslyn Analyzer Rule Exclusions (Global) =====
# CA1816: Dispose methods should call SuppressFinalize
dotnet_diagnostic.CA1816.severity = none
# CA1845: Use span-based 'string.Concat'
dotnet_diagnostic.CA1845.severity = none
# CA1859: Use concrete types when possible for improved performance
dotnet_diagnostic.CA1859.severity = none

# ===== SonarCloud Rule Exclusions (Global) =====
# S6966: ConfigureAwait not needed for application code (not a library)
dotnet_diagnostic.S6966.severity = none
# S127: Loop counter modification is valid for argument parsing patterns
dotnet_diagnostic.S127.severity = none
# S3973: Use curly braces or indentation to denote the code conditionally executed
dotnet_diagnostic.S3973.severity = none
# S3776: Cognitive Complexity of methods should not be too high
dotnet_diagnostic.S3776.severity = none

# ===== JetBrains ReSharper/InspectCode Rule Exclusions =====
# Reference: CODE_QUALITY_EXCEPTIONS.md

# JSON serialization (config classes need public setters)
resharper_auto_property_can_be_made_get_only_global_highlighting = none
resharper_property_can_be_made_init_only_global_highlighting = none
resharper_unused_auto_property_accessor_global_highlighting = none

# Public API (for external consumers)
resharper_unused_member_global_highlighting = none
resharper_unused_type_global_highlighting = none
resharper_member_can_be_private_global_highlighting = none

# Style preferences (team decision to keep traditional syntax)
resharper_convert_to_primary_constructor_highlighting = none

# Test files specific rules
[Tests/**/*.cs]
# Record.Exception() pattern - lambda executes synchronously before dispose
resharper_access_to_disposed_closure_highlighting = none
# Tests don't need cancellation support
resharper_method_supports_cancellation_highlighting = none

# ===== Roslyn Analyzer Rule Exclusions (Tests Only) =====
# CA1826: Don't use Enumerable methods on indexable collections
dotnet_diagnostic.CA1826.severity = none
# CA1861: Avoid constant arrays as arguments
dotnet_diagnostic.CA1861.severity = none
# CA2016: Forward the 'CancellationToken' parameter to methods
dotnet_diagnostic.CA2016.severity = none
# S2925: Do not use 'Thread.Sleep()' in a test
dotnet_diagnostic.S2925.severity = none

# ===== Tools Directory Rules =====
[Tools/**/*.cs]
# S107: Methods should not have too many parameters (MCP tools require many parameters)
dotnet_diagnostic.S107.severity = none
# S2368: Make this method private or simplify its parameters to not use multidimensional/jagged arrays
dotnet_diagnostic.S2368.severity = none

# ===== Helpers File-Specific Rules =====
# FontHelper.cs - Many parameters for font configuration
[Helpers/FontHelper.cs]
# S107: Methods should not have too many parameters
dotnet_diagnostic.S107.severity = none

# PptImageHelper.cs - SHA hash for image deduplication
[Helpers/PptImageHelper.cs]
# S4790: Make sure that hashing data is safe here
dotnet_diagnostic.S4790.severity = none

# ===== File-Specific Rules =====
# ApiKeyAuthenticationMiddleware.cs - JSON deserialization DTOs
[Core/Security/ApiKeyAuthenticationMiddleware.cs]
# S1144: Remove the unused private set accessor
dotnet_diagnostic.S1144.severity = none
# S3459: Remove unassigned auto-property (JSON deserialization)
dotnet_diagnostic.S3459.severity = none
# S1172: Unused method parameters (required by interface)
dotnet_diagnostic.S1172.severity = none

# JwtAuthenticationMiddleware.cs - JSON deserialization DTOs
[Core/Security/JwtAuthenticationMiddleware.cs]
# S1144: Remove the unused private set accessor
dotnet_diagnostic.S1144.severity = none
# S3459: Remove unassigned auto-property (JSON deserialization)
dotnet_diagnostic.S3459.severity = none
# S6667: Logging in a catch clause should pass the caught exception
dotnet_diagnostic.S6667.severity = none

# DocumentSessionManager.cs - IDisposable implementation
[Core/Session/DocumentSessionManager.cs]
# S3881: Fix this implementation of 'IDisposable' to conform to the dispose pattern
dotnet_diagnostic.S3881.severity = none

# TempFileManager.cs - IDisposable implementation
[Core/Session/TempFileManager.cs]
# S3881: Fix this implementation of 'IDisposable' to conform to the dispose pattern
dotnet_diagnostic.S3881.severity = none

# SessionConfig.cs - Temp directory usage
[Core/Session/SessionConfig.cs]
# S5443: Make sure publicly writable directories are used safely here
dotnet_diagnostic.S5443.severity = none

# ConvertDocumentTool.cs - String literals
[Tools/Conversion/ConvertDocumentTool.cs]
# S1192: Define a constant instead of using this literal
dotnet_diagnostic.S1192.severity = none

# RunFormatInfo.cs - Empty record used as marker
[Results/Word/Format/RunFormatInfo.cs]
# S2094: Remove this empty record
dotnet_diagnostic.S2094.severity = none

# Handler files with S3267 - Loop simplification
[Handlers/Word/Table/DeleteColumnWordTableHandler.cs]
# S3267: Loop should be simplified by calling Select
dotnet_diagnostic.S3267.severity = none

[Handlers/Word/List/GetWordListFormatHandler.cs]
# S3267: Loops should be simplified using the "Where" LINQ method
dotnet_diagnostic.S3267.severity = none

[Handlers/Word/Table/SetColumnWidthWordTableHandler.cs]
# S3267: Loop should be simplified
dotnet_diagnostic.S3267.severity = none

# WebSocketConnectionHandler.cs - Logging
[Core/Transport/WebSocketConnectionHandler.cs]
# S6667: Logging in a catch clause should pass the caught exception
dotnet_diagnostic.S6667.severity = none

# TrackingMiddleware.cs - Logging and dead stores
[Core/Tracking/TrackingMiddleware.cs]
# S6667: Logging in a catch clause should pass the caught exception
dotnet_diagnostic.S6667.severity = none
# S1854: Remove this useless assignment (intentional for clarity)
dotnet_diagnostic.S1854.severity = none

# TrackingConfig.cs - URI hardcoding
[Core/Tracking/TrackingConfig.cs]
# S1075: Refactor your code not to use hardcoded absolute paths or URIs
dotnet_diagnostic.S1075.severity = none

# McpServerBuilderExtensions.cs - Reflection usage
[Core/McpServerBuilderExtensions.cs]
# S3011: Reflection should not be used to increase accessibility
dotnet_diagnostic.S3011.severity = none

# XML and config files
[*.{xml,config,json,yml,yaml}]
indent_size = 2

# Markdown files
[*.md]
trim_trailing_whitespace = false

# PowerShell scripts
[*.ps1]
indent_size = 4
end_of_line = crlf

# Shell scripts
[*.sh]
end_of_line = lf
