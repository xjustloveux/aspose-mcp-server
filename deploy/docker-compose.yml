version: '3.8'

services:
  aspose-mcp:
    image: ghcr.io/xjustloveux/aspose-mcp-server:latest
    container_name: aspose-mcp-server
    ports:
      - "3000:3000"
    environment:
      # === Transport Settings (Required) ===
      - ASPOSE_TRANSPORT=http             # stdio, http, ws
      - ASPOSE_PORT=3000
      - ASPOSE_HOST=0.0.0.0

      # === Tools (Required) ===
      - ASPOSE_TOOLS=all                  # all, or comma-separated: word,excel,ppt,pdf,ocr,email,barcode

      # === License (Optional) ===
      # - ASPOSE_LICENSE_PATH=/app/license/Aspose.Total.lic

      # === Session Settings (Optional) ===
      # - ASPOSE_SESSION_ENABLED=true       # Enable session management (required for document_session tool)
      # - ASPOSE_SESSION_MAX=10             # Max concurrent sessions (default: 10)
      # - ASPOSE_SESSION_TIMEOUT=30         # Session timeout in minutes (default: 30)
      # - ASPOSE_SESSION_MAX_FILE_SIZE_MB=100  # Max file size in MB (min: 1, default: 100)
      # - ASPOSE_SESSION_TEMP_DIR=/tmp      # Temp directory (default: system temp)
      # - ASPOSE_SESSION_TEMP_RETENTION_HOURS=24  # Temp file retention in hours (default: 24)
      # - ASPOSE_SESSION_ON_DISCONNECT=SaveToTemp  # Session termination: AutoSave, Discard, SaveToTemp, PromptOnReconnect
      # - ASPOSE_SESSION_ISOLATION=group    # Isolation mode: none (no isolation), group (group-level, default)
      # - ASPOSE_SESSION_AUTO_SAVE_INTERVAL=0  # Auto-save interval in minutes (0 = disabled, default: 0)

      # === Extension Settings (Optional, requires Session) ===
      # - ASPOSE_EXTENSION_ENABLED=true     # Enable extension system
      # - ASPOSE_EXTENSION_CONFIG=/app/extensions/extensions.json  # Extension config file path
      # - ASPOSE_EXTENSION_TEMP_DIR=/tmp/extensions  # Snapshot temp directory
      # - ASPOSE_EXTENSION_TRANSPORT_MODE=stdin  # Default transport: mmap, stdin, file (default: stdin)
      # - ASPOSE_EXTENSION_IDLE_TIMEOUT_DEFAULT=30   # Extension idle timeout in minutes (0 = never if allowed, default: 30)
      # - ASPOSE_EXTENSION_SNAPSHOT_TTL_DEFAULT=30  # Snapshot TTL in seconds (default: 30)
      # - ASPOSE_EXTENSION_MAX_RESTARTS=3   # Max restart attempts (default: 3)
      # - ASPOSE_EXTENSION_HEALTH_INTERVAL=30  # Health check interval in seconds (default: 30)
      # - ASPOSE_EXTENSION_DEBOUNCE_DELAY_DEFAULT=100  # Debounce delay in milliseconds (default: 100)
      # - ASPOSE_EXTENSION_FRAME_INTERVAL_DEFAULT=100  # Frame interval in milliseconds (default: 100)

      # === API Key Authentication (Optional) ===
      # - ASPOSE_AUTH_APIKEY_ENABLED=true
      # - ASPOSE_AUTH_APIKEY_MODE=local    # local, gateway, introspection, custom
      # - ASPOSE_AUTH_APIKEY_KEYS=key1:group1,key2:group2
      # - ASPOSE_AUTH_APIKEY_HEADER=X-API-Key
      # - ASPOSE_AUTH_APIKEY_GROUP_HEADER=X-Group-Id
      # - ASPOSE_AUTH_APIKEY_CACHE_ENABLED=true
      # - ASPOSE_AUTH_APIKEY_CACHE_TTL=300
      # - ASPOSE_AUTH_APIKEY_CACHE_MAX_SIZE=10000
      # - ASPOSE_AUTH_APIKEY_INTROSPECTION_URL=https://auth.example.com/introspect
      # - ASPOSE_AUTH_APIKEY_INTROSPECTION_AUTH=Bearer token
      # - ASPOSE_AUTH_APIKEY_INTROSPECTION_FIELD=key
      # - ASPOSE_AUTH_APIKEY_CUSTOM_URL=https://auth.example.com/validate
      # - ASPOSE_AUTH_APIKEY_TIMEOUT=5  # External validation timeout in seconds (default: 5)

      # === JWT Authentication (Optional) ===
      # - ASPOSE_AUTH_JWT_ENABLED=true
      # - ASPOSE_AUTH_JWT_MODE=local       # local, gateway, introspection, custom
      # - ASPOSE_AUTH_JWT_SECRET=your-secret-key
      # - ASPOSE_AUTH_JWT_PUBLIC_KEY_PATH=/app/keys/public.pem
      # - ASPOSE_AUTH_JWT_ISSUER=your-issuer
      # - ASPOSE_AUTH_JWT_AUDIENCE=your-audience
      # - ASPOSE_AUTH_JWT_GROUP_CLAIM=tenant_id  # Claim for group ID (e.g., tenant_id, team_id, org_id)
      # - ASPOSE_AUTH_JWT_USER_CLAIM=sub
      # - ASPOSE_AUTH_JWT_GROUP_HEADER=X-Group-Id
      # - ASPOSE_AUTH_JWT_USER_HEADER=X-User-Id
      # - ASPOSE_AUTH_JWT_CACHE_ENABLED=true
      # - ASPOSE_AUTH_JWT_CACHE_TTL=300
      # - ASPOSE_AUTH_JWT_CACHE_MAX_SIZE=10000
      # - ASPOSE_AUTH_JWT_INTROSPECTION_URL=https://auth.example.com/introspect
      # - ASPOSE_AUTH_JWT_CLIENT_ID=your-client-id
      # - ASPOSE_AUTH_JWT_CLIENT_SECRET=your-client-secret
      # - ASPOSE_AUTH_JWT_CUSTOM_URL=https://auth.example.com/validate
      # - ASPOSE_AUTH_JWT_TIMEOUT=5  # External validation timeout in seconds (default: 5)

      # === Logging (Optional) ===
      # - ASPOSE_LOG_ENABLED=true
      # - ASPOSE_LOG_TARGETS=Console       # Console, EventLog (Windows only)

      # === Webhook (Optional) ===
      # - ASPOSE_WEBHOOK_URL=https://your-webhook.example.com/events
      # - ASPOSE_WEBHOOK_AUTH_HEADER=Bearer your-token

      # === Prometheus Metrics (Optional) ===
      # - ASPOSE_METRICS_ENABLED=true
      # - ASPOSE_METRICS_PATH=/metrics

      # === Origin Validation (Optional, HTTP/WS only) ===
      # - ASPOSE_ORIGIN_VALIDATION=true        # Enable origin validation (default: true)
      # - ASPOSE_ALLOW_LOCALHOST=true          # Allow localhost origin (default: true)
      # - ASPOSE_ALLOW_MISSING_ORIGIN=true     # Allow requests without Origin header (default: true)
      # - ASPOSE_ALLOWED_ORIGINS=https://app1.com,https://app2.com

    # === Volumes (Optional) ===
    # volumes:
    #   - ./license:/app/license:ro
    #   - ./documents:/app/documents
    #   - ./extensions:/app/extensions:ro    # Extension config and binaries

    # === Restart Policy (Optional) ===
    # restart: unless-stopped

    # === Health Check (Optional) ===
    # healthcheck:
    #   test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
    #   interval: 30s
    #   timeout: 3s
    #   retries: 3
