version: '3.8'

services:
  aspose-mcp:
    image: ghcr.io/xjustloveux/aspose-mcp-server:latest
    container_name: aspose-mcp-server
    ports:
      - "3000:3000"
    environment:
      # === Transport Settings (Required) ===
      - ASPOSE_TRANSPORT=http             # stdio, http, ws
      - ASPOSE_PORT=3000
      - ASPOSE_HOST=0.0.0.0

      # === Tools (Required) ===
      - ASPOSE_TOOLS=all                  # all, or comma-separated: word,excel,pdf,ppt

      # === License (Optional) ===
      # - ASPOSE_LICENSE_PATH=/app/license/Aspose.Total.lic

      # === Session Settings (Optional) ===
      # - ASPOSE_SESSION_ENABLED=true       # Enable session management (required for document_session tool)
      # - ASPOSE_SESSION_MAX=10             # Max concurrent sessions (default: 10)
      # - ASPOSE_SESSION_TIMEOUT=30         # Session timeout in minutes (default: 30)
      # - ASPOSE_SESSION_MAX_FILE_SIZE_MB=100  # Max file size in MB (default: 100)
      # - ASPOSE_SESSION_TEMP_DIR=/tmp      # Temp directory (default: system temp)
      # - ASPOSE_SESSION_TEMP_RETENTION_HOURS=24  # Temp file retention in hours (default: 24)
      # - ASPOSE_SESSION_ON_DISCONNECT=SaveToTemp  # Disconnect behavior: SaveToTemp, Discard, KeepInMemory
      # - ASPOSE_SESSION_ISOLATION=group    # Isolation mode: none (no isolation), group (group-level, default)

      # === API Key Authentication (Optional) ===
      # - ASPOSE_AUTH_APIKEY_ENABLED=true
      # - ASPOSE_AUTH_APIKEY_MODE=local    # local, gateway, introspection, custom
      # - ASPOSE_AUTH_APIKEY_KEYS=key1:group1,key2:group2
      # - ASPOSE_AUTH_APIKEY_HEADER=X-API-Key
      # - ASPOSE_AUTH_APIKEY_GROUP_HEADER=X-Group-Id
      # - ASPOSE_AUTH_APIKEY_CACHE_ENABLED=true
      # - ASPOSE_AUTH_APIKEY_CACHE_TTL=300
      # - ASPOSE_AUTH_APIKEY_CACHE_MAX_SIZE=10000
      # - ASPOSE_AUTH_APIKEY_INTROSPECTION_URL=https://auth.example.com/introspect
      # - ASPOSE_AUTH_APIKEY_INTROSPECTION_AUTH=Bearer token
      # - ASPOSE_AUTH_APIKEY_CUSTOM_URL=https://auth.example.com/validate
      # - ASPOSE_AUTH_APIKEY_CUSTOM_TIMEOUT=5

      # === JWT Authentication (Optional) ===
      # - ASPOSE_AUTH_JWT_ENABLED=true
      # - ASPOSE_AUTH_JWT_MODE=local       # local, gateway, introspection, custom
      # - ASPOSE_AUTH_JWT_SECRET=your-secret-key
      # - ASPOSE_AUTH_JWT_PUBLIC_KEY_PATH=/app/keys/public.pem
      # - ASPOSE_AUTH_JWT_ISSUER=your-issuer
      # - ASPOSE_AUTH_JWT_AUDIENCE=your-audience
      # - ASPOSE_AUTH_JWT_GROUP_CLAIM=tenant_id  # Claim for group ID (e.g., tenant_id, team_id, org_id)
      # - ASPOSE_AUTH_JWT_USER_CLAIM=sub
      # - ASPOSE_AUTH_JWT_GROUP_HEADER=X-Group-Id
      # - ASPOSE_AUTH_JWT_USER_HEADER=X-User-Id
      # - ASPOSE_AUTH_JWT_CACHE_ENABLED=true
      # - ASPOSE_AUTH_JWT_CACHE_TTL=300
      # - ASPOSE_AUTH_JWT_CACHE_MAX_SIZE=10000
      # - ASPOSE_AUTH_JWT_INTROSPECTION_URL=https://auth.example.com/introspect
      # - ASPOSE_AUTH_JWT_CLIENT_ID=your-client-id
      # - ASPOSE_AUTH_JWT_CLIENT_SECRET=your-client-secret
      # - ASPOSE_AUTH_JWT_CUSTOM_URL=https://auth.example.com/validate
      # - ASPOSE_AUTH_JWT_CUSTOM_TIMEOUT=5

      # === Logging (Optional) ===
      # - ASPOSE_LOG_ENABLED=true
      # - ASPOSE_LOG_TARGETS=Console       # Console, EventLog (Windows only)

      # === Webhook (Optional) ===
      # - ASPOSE_WEBHOOK_URL=https://your-webhook.example.com/events
      # - ASPOSE_WEBHOOK_AUTH_HEADER=Bearer your-token

      # === Prometheus Metrics (Optional) ===
      # - ASPOSE_METRICS_ENABLED=true
      # - ASPOSE_METRICS_PATH=/metrics

    # === Volumes (Optional) ===
    # volumes:
    #   - ./license:/app/license:ro
    #   - ./documents:/app/documents

    # === Restart Policy (Optional) ===
    # restart: unless-stopped

    # === Health Check (Optional) ===
    # healthcheck:
    #   test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
    #   interval: 30s
    #   timeout: 3s
    #   retries: 3
