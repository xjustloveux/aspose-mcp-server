<?xml version="1.0" encoding="utf-8"?>

<configuration>
  <location path="." inheritInChildApplications="false">
    <system.webServer>
      <handlers>
        <add name="aspNetCore" path="*" verb="*"
             modules="AspNetCoreModuleV2" resourceType="Unspecified" />
      </handlers>

      <!-- ASP.NET Core Module Configuration -->
      <aspNetCore processPath="dotnet"
                  arguments=".\AsposeMcpServer.dll"
                  stdoutLogEnabled="false"
                  stdoutLogFile=".\logs\stdout"
                  hostingModel="InProcess">
        <environmentVariables>
          <!-- Transport Settings (Required) -->
          <environmentVariable name="ASPOSE_TRANSPORT" value="http" />
          <environmentVariable name="ASPOSE_PORT" value="3000" />
          <!-- <environmentVariable name="ASPOSE_HOST" value="localhost" /> -->

          <!-- Tools (Required) -->
          <environmentVariable name="ASPOSE_TOOLS" value="all" />

          <!-- License Path (Optional) -->
          <!-- <environmentVariable name="ASPOSE_LICENSE_PATH" value=".\Aspose.Total.lic" /> -->

          <!-- Session Settings (Optional) -->
          <!-- <environmentVariable name="ASPOSE_SESSION_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_SESSION_MAX" value="10" /> -->
          <!-- <environmentVariable name="ASPOSE_SESSION_TIMEOUT" value="30" /> -->
          <!-- <environmentVariable name="ASPOSE_SESSION_MAX_FILE_SIZE_MB" value="100" /> -->
          <!-- <environmentVariable name="ASPOSE_SESSION_TEMP_DIR" value="C:\Temp" /> -->
          <!-- <environmentVariable name="ASPOSE_SESSION_TEMP_RETENTION_HOURS" value="24" /> -->
          <!-- <environmentVariable name="ASPOSE_SESSION_ON_DISCONNECT" value="SaveToTemp" /> --> <!-- Session termination: AutoSave, Discard, SaveToTemp, PromptOnReconnect -->
          <!-- <environmentVariable name="ASPOSE_SESSION_ISOLATION" value="group" /> --> <!-- none (no isolation), group (group-level, default) -->
          <!-- <environmentVariable name="ASPOSE_SESSION_AUTO_SAVE_INTERVAL" value="0" /> --> <!-- Auto-save interval in minutes (0 = disabled, default: 0) -->

          <!-- Origin Validation (Optional, HTTP/WS only) -->
          <!-- <environmentVariable name="ASPOSE_ORIGIN_VALIDATION" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_ALLOW_LOCALHOST" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_ALLOW_MISSING_ORIGIN" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_ALLOWED_ORIGINS" value="https://app1.com,https://app2.com" /> -->

          <!-- Logging (Optional) -->
          <!-- <environmentVariable name="ASPOSE_LOG_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_LOG_TARGETS" value="Console" /> --> <!-- Console, EventLog (Windows only) -->

          <!-- Webhook (Optional) -->
          <!-- <environmentVariable name="ASPOSE_WEBHOOK_URL" value="https://your-webhook.example.com/events" /> -->
          <!-- <environmentVariable name="ASPOSE_WEBHOOK_AUTH_HEADER" value="Bearer your-token" /> -->

          <!-- Prometheus Metrics (Optional) -->
          <!-- <environmentVariable name="ASPOSE_METRICS_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_METRICS_PATH" value="/metrics" /> -->

          <!-- API Key Authentication (Optional) -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_MODE" value="local" /> --> <!-- local, gateway, introspection, custom -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_KEYS" value="key1:group1,key2:group2" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_HEADER" value="X-API-Key" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_GROUP_HEADER" value="X-Group-Id" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_CACHE_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_CACHE_TTL" value="300" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_CACHE_MAX_SIZE" value="10000" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_INTROSPECTION_URL" value="https://auth.example.com/introspect" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_INTROSPECTION_AUTH" value="Bearer token" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_INTROSPECTION_FIELD" value="key" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_CUSTOM_URL" value="https://auth.example.com/validate" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_APIKEY_TIMEOUT" value="5" /> --> <!-- External validation timeout (default: 5) -->

          <!-- Extension Settings (Optional, requires Session to be enabled) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_CONFIG" value=".\extensions.json" /> -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_TEMP_DIR" value="C:\Temp\Extensions" /> -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_TRANSPORT_MODE" value="stdin" /> --> <!-- mmap, stdin, file (default: stdin) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_IDLE_TIMEOUT_DEFAULT" value="30" /> --> <!-- Minutes, 0 = never if allowed (default: 30) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_SNAPSHOT_TTL_DEFAULT" value="30" /> --> <!-- Seconds (default: 30) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_MAX_RESTARTS" value="3" /> --> <!-- Max restart attempts (default: 3) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_HEALTH_INTERVAL" value="30" /> --> <!-- Seconds (default: 30) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_DEBOUNCE_DELAY_DEFAULT" value="100" /> --> <!-- Milliseconds (default: 100) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_FRAME_INTERVAL_DEFAULT" value="100" /> --> <!-- Milliseconds (default: 100) -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_MAX_SNAPSHOT_SIZE" value="104857600" /> --> <!-- Bytes, default: 100 MB -->
          <!-- <environmentVariable name="ASPOSE_EXTENSION_MIN_FREE_DISK_SPACE" value="524288000" /> --> <!-- Bytes, default: 500 MB -->

          <!-- JWT Authentication (Optional) -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_MODE" value="local" /> --> <!-- local, gateway, introspection, custom -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_SECRET" value="your-secret-key" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_PUBLIC_KEY_PATH" value=".\keys\public.pem" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_ISSUER" value="your-issuer" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_AUDIENCE" value="your-audience" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_GROUP_CLAIM" value="tenant_id" /> --> <!-- Claim for group ID (e.g., tenant_id, team_id, org_id) -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_USER_CLAIM" value="sub" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_GROUP_HEADER" value="X-Group-Id" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_USER_HEADER" value="X-User-Id" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_CACHE_ENABLED" value="true" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_CACHE_TTL" value="300" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_CACHE_MAX_SIZE" value="10000" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_INTROSPECTION_URL" value="https://auth.example.com/introspect" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_CLIENT_ID" value="your-client-id" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_CLIENT_SECRET" value="your-client-secret" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_CUSTOM_URL" value="https://auth.example.com/validate" /> -->
          <!-- <environmentVariable name="ASPOSE_AUTH_JWT_TIMEOUT" value="5" /> --> <!-- External validation timeout (default: 5) -->
        </environmentVariables>
      </aspNetCore>

      <!-- WebSocket Support (Optional, for WebSocket transport mode) -->
      <!-- <webSocket enabled="true" /> -->

      <!-- Request Timeout for HTTP (Optional, for long-running connections) -->
      <!-- <httpRuntime executionTimeout="3600" /> -->

      <!-- Security Headers (Optional) -->
      <!--
            <httpProtocol>
                <customHeaders>
                    <remove name="X-Powered-By" />
                    <add name="X-Content-Type-Options" value="nosniff" />
                    <add name="X-Frame-Options" value="DENY" />
                    <add name="X-XSS-Protection" value="1; mode=block" />
                </customHeaders>
            </httpProtocol>
            -->

      <!-- Compression (Optional) -->
      <!-- <urlCompression doStaticCompression="true" doDynamicCompression="true" /> -->

      <!-- Error Handling (Optional) -->
      <!-- <httpErrors errorMode="DetailedLocalOnly" /> -->
    </system.webServer>
  </location>

  <!-- Encoding Settings (Optional) -->
  <!--
    <system.web>
        <globalization requestEncoding="utf-8" responseEncoding="utf-8" />
    </system.web>
    -->
</configuration>
